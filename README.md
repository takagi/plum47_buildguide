# Plum47 ビルドガイド

自作キーボードキット「Plum47」のビルドガイドです。

## 目次

- はんだ付け
- 動作確認
- ケースの組み立て
- ファームウェア
- デフォルトキーマップ

## はんだ付け

### PCB の確認

まず、PCB の向きを確認します。

**表**

![PCB 表](https://github.com/takagi/plum47_buildguide/raw/master/images/img01.jpg)

**裏**

![PCB 裏](https://github.com/takagi/plum47_buildguide/raw/master/images/img02.jpg)

キースイッチの四隅にあたる白い印が並んでいる方が表、格子状の配線があり銀色のパッドが並んでいる方が裏です。また、Pro Micro を取り付ける穴がある方が（表からみて）左側になります。

### ダイオードのはんだ付け

PCB の裏面にダイオードをはんだ付けします。

![ダイオードのはんだ付け](https://github.com/takagi/plum47_buildguide/raw/master/images/img03.jpg)

ダイオードには向きがあるので注意してください。見づらいですが、ダイオードの上面に線が印刷されています。その線と、PCB にシルクで印刷されている回路記号の三角形の先の線が、同じ向きになるようにします。

細かい部品の表面実装なので難しそうだと感じるかもしれませんが、同じことを 47 回繰り返すのでやっているうちに慣れます。電気的に繋がりさえすればいいので、多少まがっても問題ありません。

ダイオードの向きを間違っても、きちんと動作しないだけでキーボードが壊れることはないので、その点も心配しないでください。あとで間違いに気づいた場合は、はんだ吸い取り線などでダイオードを取り外して正しい向きにはんだ付けしなおせば大丈夫です。

### MX ソケットのはんだ付け

同じくPCB の裏面に MX ソケットをはんだ付けします。

![MX ソケットのはんだ付け](https://github.com/takagi/plum47_buildguide/raw/master/images/img04.jpg)

PCB の穴にソケットをはめ込み、両側のパッドをそれぞれはんだ付けします。

コツとしては、予備はんだをせずにソケットをはめてからはんだを流し込み、ソケットを押さえて浮かないようにしつつはんだごてを離すと、うまくいきます。

スペースバーだけスタビライザーの関係でキースイッチが上下逆になっているので、ソケットの向きに注意してください。（上下逆でも穴にはめ込むことができてしまいます）

また、Pro Micro の裏面の MX ソケットですが、コンスルーとの間隔がぎりぎりになるので、干渉しないよう先にコンスルーを PCB に差し込んでおいてから MX ソケットをはんだ付けするとよいです。

### Pro Micro とコンスルーのはんだ付け

Pro Micro にコンスルーをはんだ付けします。

![Pro Micro とコンスルーのはんだ付け](https://github.com/takagi/plum47_buildguide/raw/master/images/img05.jpg)

MX ソケットをまたぐように PCB に取り付けるため、Pro Micro は部品が外側を向くようにはんだ付けします。

また、コンスルーには向きがあります。側面から金具がみえる窓が同一方向を向くように揃えます。[こちら](https://biacco42.hatenablog.com/entry/2019/08/10/185624#%E3%82%B3%E3%83%B3%E3%82%B9%E3%83%AB%E3%83%BC%E3%81%AE%E5%9B%BA%E5%AE%9A%E6%96%B9%E5%90%91)がわかりやすいです。

以上ではんだ付けは終わりです。

## 動作確認

問題があったときに対処しやすいよう、ケースを組み立てる前に動作確認をします。

Pro Micro を裏面から PCB に差込み、USB ケーブルでパソコンと繋ぎます。ファームウェアは、ご購入時に Pro Micro に書き込み済みです。

以下のサイトを使うと確認しやすいです。

https://keyboardchecker.com/

表面から MX ソケットの穴をピンセットなどで短絡させると、キーを押したのと同じ状態を作れます。

![ピンセットで短絡](https://github.com/takagi/plum47_buildguide/raw/master/images/img06.jpg)

デフォルトキーマップは、[こちら](#%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%82%AD%E3%83%BC%E3%83%9E%E3%83%83%E3%83%97)をご覧ください。

## ケースの組み立て

問題なく動作することが確認できたら、最後にケースを組み立てます。

### スタビライザーの取り付け（任意）

任意で PCB にスタビライザーを取り付けます。金属のバーが奥になるよう、PCB の表面にはめ込みます。

### トッププレートとボトムプレートの組み立て

まずトッププレートの向きを確認します。（写真は試作品のものであるため、キットに含まれているものと多少異なります）

![トッププレート](https://github.com/takagi/plum47_buildguide/raw/master/images/img07.jpg)

両側に穴が２つずつあると思いますが、上からみて２つの穴がずれている方が左側になります。ずれている部分には Pro Micro がきます。

保護紙をはがして、8mm ネジ５つをトッププレートに通します。このあとプレートをひっくり返すので、ネジが落ちないように頭をマスキングテープなどで仮留めします。

![ネジの仮留め](https://github.com/takagi/plum47_buildguide/raw/master/images/img08.jpg)

トッププレートをひっくり返して、2mm スペーサー５つを 8mm ネジに通します。

PCB を裏面が上になるように被せて 8mm ネジに通し、4mm スペーサー５つで 8mm ネジを留めます。あとでしっかり締めるので、ここではネジが落ちない程度で大丈夫です。

保護紙をはがしたボトムプレートを、切り欠きが Pro Micro と一致するように被せて、5mm ネジで留めます。両側からネジをしっかりと締めます。

### キースイッチとキーキャップの取り付け

キースイッチを MX ソケットに差し込みます。５ピンのキースイッチの場合は、ある程度力を入れて PCB に押し込む形になると思います。

このとき、キースイッチのピンがまっすぐになっていることを確認してから差し込んでください。斜めになっていると、ピンが PCB ソケットに刺さらず曲がってしまいます。前述の項と同様に動作確認をしながら進めるとよいです。

キースイッチをすべて取り付けたら、キーキャップをはめてください。

### ゴム足の取り付け

最後に、ゴム足をボトムプレートの四隅に貼り付けます。

![ゴム足の取り付け](https://github.com/takagi/plum47_buildguide/raw/master/images/img09.jpg)

キースイッチの中央の突起の中心にゴム足の中心がくるように貼ると、きれいに仕上がります。

以上で完成です。

## ファームウェア

ファームウェアはご購入時にすでに Pro Micro に書き込んであるため、組み立てが終わればすぐに PC につないで使用することができます。

キーマップやファームウェアの挙動を変更したい場合は、まだ本家 QMK に登録されていないため、以下の QMK をご利用ください。

https://github.com/takagi/qmk_firmware

## デフォルトキーマップ

デフォルトのキーマップは、Planck キーボードに倣ったものになっています。

![Planck Default Keymap](https://github.com/takagi/plum47_buildguide/raw/master/images/img10.jpg)

https://github.com/olkb/olkb_parts/blob/master/planck/planck-keymap-MD3.pdf

各キーを単体で押した場合の入力が真ん中の黒字、Raise キーと同時に押した場合の入力が右上のオレンジ色、Lower キーと同時に押した場合の入力が左下の水色で示されています。

※Fn キーは未割り当てです
